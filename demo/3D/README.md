### 1. WebGL平行光下的漫反射光的计算
<漫反射光颜色>=<入射光颜色>x<表面基底色>x cos θ

所以，我们要计算出来漫反射的光的颜色需要三项数据：

（1）平行入射光的颜色

（2）表面的基底色

（3）入射光与表面形成的入射角  θ

但是，我们没有办法直接就确定 θ值是多少，我们必须根据入射光的方向和物体表面的朝向（即法线方向）来计算出入射角。这需要我们先确定每个表面的朝向，在指定光源的时候，再确定光的方向，来计算出入射角，并确定 θ的值。

幸运的是，我们可以通过计算两个矢量的点积，来计算着两个矢量的夹角余弦值cos  θ。点积运算的使用非常频繁，GLSL ES内置了点积运算函数（详见GLSL ES中的第11节，11 WebGL 着色器编程语言GLSL ES的内置函数）。在公式中，我们使用点符号 · 来表示点积运算。这样，cos θ就可以通过下式计算出来：

cos θ = <光线方向> · <法线方向>

所以，上面计算平行光下的漫反射的颜色的式子就可以修改成：

<漫反射光颜色> = <入射光颜色> x <表面基底色> x (<光线方向> · <法线方向>)

这里有两点需要注意：

（1）光线方向矢量和表面法线矢量的长度必须为1，否则反射光的颜色就会过暗或过亮。将一个矢量的长度调整为1，同时保持方向不变的过程称之为归一化。GLSL ES提供了内置的归一化函数，你可以直接使用。

（2）这里所谓的“光线方向”，实际上是入射方向的反方向，即从入射点指向光源方向（因为这样，该方向与法线方向的夹角才是入射角），如图。

### 2.  WebGL环境光下的漫反射光的计算
根据上一节的案例，我们需要将环境反射光颜色计算出来，然后获取真实的颜色。

首先我们使用：

<环境反射光颜色>=<入射光颜色> x <表面基底色>

来计算出环境反射光的颜色，然后再通过

<表面的反射光颜色> = <漫反射光颜色> + <环境反射光颜色>

来获取表面实际的反射光颜色。

